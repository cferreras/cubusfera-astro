---
interface Props {
    type?: "error" | "offline" | "info" | "warning";
    title?: string;
    message: string;
    showHelpText?: boolean;
    helpText?: string;
    className?: string;
}

const {
    type = "error",
    title,
    message,
    showHelpText = false,
    helpText,
    className = "",
} = Astro.props;

// Determinar si es servidor offline basado en el mensaje o tipo
const isServerOffline =
    type === "offline" ||
    message.includes("servidor") ||
    message.includes("desconectado");

// Configuraci√≥n de colores seg√∫n el tipo
const getColorClasses = () => {
    if (isServerOffline) {
        return {
            container:
                "bg-green-50 dark:bg-[#1b3124] border-green-200 dark:border-[#366348]",
            iconWrapper: "bg-green-100 dark:bg-[#264532]",
            icon: "text-green-600 dark:text-[#38e07b]",
            title: "text-green-700 dark:text-[#38e07b]",
            message: "text-green-600 dark:text-[#96c5a9]",
            help: "text-green-600 dark:text-[#96c5a9]",
        };
    }

    switch (type) {
        case "warning":
            return {
                container:
                    "bg-yellow-50 dark:bg-yellow-950/30 border-yellow-200 dark:border-yellow-800",
                iconWrapper: "bg-yellow-100 dark:bg-yellow-900/30",
                icon: "text-yellow-500 dark:text-yellow-400",
                title: "text-yellow-700 dark:text-yellow-300",
                message: "text-yellow-600 dark:text-yellow-400",
                help: "text-yellow-600 dark:text-yellow-400",
            };
        case "info":
            return {
                container:
                    "bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800",
                iconWrapper: "bg-blue-100 dark:bg-blue-900/30",
                icon: "text-blue-500 dark:text-blue-400",
                title: "text-blue-700 dark:text-blue-300",
                message: "text-blue-600 dark:text-blue-400",
                help: "text-blue-600 dark:text-blue-400",
            };
        case "error":
        default:
            return {
                container:
                    "bg-red-50 dark:bg-red-950/30 border-red-200 dark:border-red-800",
                iconWrapper: "bg-red-100 dark:bg-red-900/30",
                icon: "text-red-500 dark:text-red-400",
                title: "text-red-700 dark:text-red-300",
                message: "text-red-600 dark:text-red-400",
                help: "text-red-600 dark:text-red-400",
            };
    }
};

const colors = getColorClasses();

// Determinar el t√≠tulo por defecto seg√∫n el tipo
const defaultTitle = isServerOffline
    ? "Servidor desconectado"
    : type === "warning"
      ? "Advertencia"
      : type === "info"
        ? "Informaci√≥n"
        : "Error";

const displayTitle = title || defaultTitle;

// Texto de ayuda por defecto para servidor offline
const defaultHelpText = isServerOffline
    ? "üí° Esto es normal cuando el servidor est√° apagado. La web funciona correctamente."
    : helpText;

const shouldShowHelp =
    showHelpText || (isServerOffline && !helpText) || helpText;
---

<div
    class={`p-6 text-center border rounded-lg ${colors.container} ${className}`}
>
    <div
        class={`flex items-center justify-center w-16 h-16 mx-auto mb-4 rounded-full ${colors.iconWrapper}`}
    >
        <svg
            class={`w-8 h-8 ${colors.icon}`}
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
        >
            {
                isServerOffline ? (
                    <>
                        <circle
                            cx="12"
                            cy="12"
                            r="10"
                            stroke-width="2"
                            fill="none"
                        />
                        <line
                            x1="4.93"
                            y1="4.93"
                            x2="19.07"
                            y2="19.07"
                            stroke-width="2"
                            stroke-linecap="round"
                        />
                    </>
                ) : type === "warning" ? (
                    <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"
                    />
                ) : type === "info" ? (
                    <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                    />
                ) : (
                    <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                    />
                )
            }
        </svg>
    </div>

    <h3 class={`mb-2 text-lg font-semibold ${colors.title}`}>
        {displayTitle}
    </h3>

    <p class={`${colors.message}`}>
        {message}
    </p>

    {
        shouldShowHelp && (
            <p class={`mt-3 text-xs ${colors.help}`}>{defaultHelpText}</p>
        )
    }
</div>
